{% comment %}
	Renders a product card as grid item

	Accepts:
	- product: {Object} Product Liquid object (required)
	- wishlist: {String} 'toggle' | 'remove' | 'add'
	- itemsPerRow {Number} Number of product card grid siblings
	- showBadges: {Boolean} true | false
	- showManufacturer: {Boolean} true | false
	- showProductName: {Boolean} true | false
	- showPricing: {Boolean} true | false

	Usage:
	{% render 'product-card-grid', product: product %}
{% endcomment %}

{%- case wishlist -%}

    {% when 'toggle' %}
        {%- assign wishlistAction = 'toggle' -%}
    {% when 'remove' %}
        {%- assign wishlistAction = 'remove' -%}
    {% when 'add' %}
        {%- assign wishlistAction = 'add' -%}
    {% else %}
        {%- assign wishlistAction = false -%}

{%- endcase -%}

{%- if itemsPerRow != false -%}
	{%- assign itemsPerRow = 4 -%}
{%- endif -%}

{%- if showBadges != false -%}
	{%- assign showBadges = true -%}
{%- endif -%}

{%- if showManufacturer != false -%}
	{%- assign showManufacturer = true -%}
{%- endif -%}

{%- if showProductName != false -%}
	{%- assign showProductName = true -%}
{%- endif -%}

{%- if showPricing != false -%}
	{%- assign showPricing = true -%}
{%- endif -%}

<div class="product-card-grid-item{% if product.has_discount %} product-has-discount{% endif %}">

	<div class="product-media-container">

		{% if showBadges %}

			{% render 'product-badges', product: product, postion: 'left-bottom' %}

		{% endif %}

		{% if wishlistAction and store.session.logged_in %}

			<div class="product-wishlist-action-container">

		        <button type="button" class="btn btn-text p-2 product-wishlist-action" data-wishlist-{{- wishlistAction -}}="{{ product.id }}" aria-pressed="{{ product.in_wishlist | yepnope: 'true', 'false' }}">
		            {%- render 'icon', icon: 'love-it-08UZOs', class: 'svg-icon-lg svg-icon-fw svg-icon-2x' -%}
		        </button>

		    </div>

		{% endif %}

		<a href="{{ product | page_url }}">

			<div class="product-media">

				<div class="product-media-img-container aspect-ratio-container">

	  				{%- assign imgSrc = product.image | default: settings.placeholderImgSrc | default: settings.placeholderDefaultImgSrc | asset_url -%}
	  				{%- assign imgSizeSm = 348,348 -%}
	  				{%- assign imgSizeMd = 290,290 -%}

	  				{%- case itemsPerRow -%}

					    {% when '2' %}
					        {%- assign imgSizeLg = 810,810 -%}
					    {% when '3' %}
					        {%- assign imgSizeLg = 520,520 -%}
					    {% when '4' %}
					        {%- assign imgSizeLg = 376,376 -%}
					    {% when '5' %}
					        {%- assign imgSizeLg = 290,290 -%}
					    {% when '6' %}
					    	{%- assign imgSizeLg = 232,232 -%}

					{%- endcase -%}

		  			<picture>
				        <source media="(min-width: 992px)" data-srcset="
				            {{ imgSrc | thumb: imgSizeLg }} 1x,
				            {{ imgSrc | thumb: imgSizeLg | thumb:'@2x' }} 2x">

				            <source media="(min-width: 576px)" data-srcset="
				            {{ imgSrc | thumb: imgSizeMd }} 1x,
				            {{ imgSrc | thumb: imgSizeMd | thumb:'@2x' }} 2x">

				        <img
				            alt="{{ product.name }}"
				            data-src="{{ imgSrc | thumb: imgSizeSm }}"
				            data-srcset="{{ imgSrc | thumb: imgSizeSm }} 1x, {{ imgSrc | thumb: imgSizeSm | thumb:'@2x' }} 2x"
				            class="lazy d-block mx-auto img-fluid aspect-ratio-item">
				    </picture>

				</div>

  			</div>

		</a>

	</div>

	<div class="product-caption">

		<a href="{{ product | page_url }}">

			{% if showManufacturer %}

				<div class="product-manufacturer">

					<span class="product-manufacturer-name">
						{{ product.manufacturer.name }}
					</span>

				</div>

			{% endif %}

			{% if showProductName %}

				<div class="product-name">

					<h3 class="product-name-text">
						{{ product.name }}
					</h3>

				</div>

			{% endif %}

			{% if showPricing %}

				<div class="product-price">

					{% if product.has_discount %}

						<span class="text-sale-price font-weight-bold mr-2">
							{{ product.price | in_currency }}
						</span>

			            <span class="text-decoration-line-through text-muted">
			            	{{ product.original_price | in_currency }}
			            </span>

			        {% else %}

			        	<span class="text-price">
							{{ product.price | in_currency }}
						</span>

			        {% endif %}

				</div>

			{% endif %}

		</a>

	</div>

</div>